<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase 筆記管理系統</title>
    <!-- 引入 Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database.js"></script>
</head>
<body>
    <div class="container my-5">
        <h1 class="text-center mb-4">Firebase 筆記管理系統</h1>

        <!-- 功能按鈕 -->
        <div class="text-end mb-4">
            <button class="btn btn-primary me-2">會員信息</button>
            <button class="btn btn-danger">登出</button>
        </div>

        <!-- 筆記管理 -->
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">新增筆記</h5>
            </div>
            <div class="card-body">
                <form id="note-form">
                    <div class="mb-3">
                        <label for="title" class="form-label">標題</label>
                        <input type="text" class="form-control" id="title" placeholder="輸入標題">
                    </div>
                    <div class="mb-3">
                        <label for="content" class="form-label">內容</label>
                        <textarea class="form-control" id="content" rows="3" placeholder="輸入內容"></textarea>
                    </div>
                    <button type="button" class="btn btn-success" onclick="addNote()">新增筆記</button>
                </form>
            </div>
        </div>

        <!-- 筆記列表 -->
        <div class="card">
            <div class="card-header bg-secondary text-white">
                <h5 class="mb-0">筆記列表</h5>
            </div>
            <ul class="list-group list-group-flush" id="note-list">
                <!-- 筆記將從 Firebase 加載 -->
            </ul>
        </div>
    </div>

    <script>
        // Firebase 配置
        const firebaseConfig = {
    apiKey: "AIzaSyBD4L9AglSZECDBgboOolAOIw_31qbNv8c",
    authDomain: "wk-57f11.firebaseapp.com",
    databaseURL: "https://wk-57f11-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "wk-57f11",
    storageBucket: "wk-57f11.firebasestorage.app",
    messagingSenderId: "355172531717",
    appId: "1:355172531717:web:260f9a31b6ec7e9d12a66c",
    measurementId: "G-ET7WHJGS76"
  };

        // 初始化 Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // 新增筆記
        function addNote() {
            const title = document.getElementById('title').value;
            const content = document.getElementById('content').value;

            if (title && content) {
                const notesRef = firebase.database().ref('notes');
                const newNote = notesRef.push(); // 建立新節點
                newNote.set({
                    title: title,
                    content: content,
                    timestamp: Date.now()
                });

                // 清空輸入框
                document.getElementById('title').value = '';
                document.getElementById('content').value = '';
            }
        }

        // 顯示筆記
        const notesRef = firebase.database().ref('notes');
        notesRef.on('value', (snapshot) => {
            const noteList = document.getElementById('note-list');
            noteList.innerHTML = ''; // 清空列表

            const notes = snapshot.val();
            for (const id in notes) {
                const note = notes[id];
                const noteItem = document.createElement('li');
                noteItem.className = 'list-group-item';
                noteItem.innerHTML = `
                    <strong>${note.title}：</strong> ${note.content}
                    <div class="float-end">
                        <button class="btn btn-warning btn-sm me-2" onclick="editNote('${id}')">編輯</button>
                        <button class="btn btn-danger btn-sm" onclick="deleteNote('${id}')">刪除</button>
                    </div>
                `;
                noteList.appendChild(noteItem);
            }
        });

        // 刪除筆記
        function deleteNote(id) {
            const noteRef = firebase.database().ref(`notes/${id}`);
            noteRef.remove();
        }

        // 編輯筆記（暫時用警示框）
        function editNote(id) {
            const noteRef = firebase.database().ref(`notes/${id}`);
            noteRef.once('value', (snapshot) => {
                const note = snapshot.val();
                const newTitle = prompt('編輯標題', note.title);
                const newContent = prompt('編輯內容', note.content);

                if (newTitle && newContent) {
                    noteRef.set({
                        title: newTitle,
                        content: newContent,
                        timestamp: Date.now()
                    });
                }
            });
        }
    </script>
</body>
</html>
